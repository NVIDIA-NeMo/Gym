## Details 

This is a resource server for sudoku text based game. The correctness is checked programtically. The reward is returned at each step (each call of the `make_move` function. The final reward is the sum)

**Dataset**: The dataset is proceduraly generated. But for it to be compatible with current trajectory generation framework. We have a `simple_sudoku.jsonl` and a script (steps below) that can be used to create a jsonl to use for trajectory generation. This would be changed later


## Steps to run

1. Download reference dataset

```
ng_download_dataset_to_gitlab \
    +dataset_name=simple_sudoku \
    +version=0.0.2 \
    +artifact_fpath=simple_sudoku.jsonl \
    +output_fpath=data/simple_sudoku.jsonl
```

2. Create a larger jsonl (the reference dataset just has 1 data point as reference for how the system prompt, tool definition should look like). Below generates 5 examples. Currently the game parameters , board size & number of clues are selected randomly in a reasonable range (4 & 9 for board size and btw (6,12) for board of sizse 4 and (16, 48) for board size 9. In the future we could replace this with a parameter of how tough we want the game)

Run below from the `simple_sudoku/` folder
```
python generate_sudoku_jsonl.py ../../data/simple_sudoku.jsonl 5 ../../data/sudoku_batch.jsonl
```


2. Start the servers (this starts the simple_game_agent, the model server & the sudkoku environment server)

```
ng_run "+config_paths=[responses_api_agents/simple_game_agent/configs/simple_game_agent.yaml,responses_api_models/openai_model/configs/openai_model.yaml,resources_servers/simple_sudoku/configs/simple_sudoku.yaml]" +simple_game_agent.responses_api_agents.simple_game_agent.resources_server.name=simple_sudoku
```

3. Start trajectory collection

```
ng_collect_traj +agent_name=simple_game_agent +input_jsonl_fpath=data/sudoku_batch.jsonl +output_jsonl_fpath=results/sudoku_output.jsonl
```

---

**Example Rollouts**:

```
{"responses_create_params": {"input": [], "tools": [{"name": "make_move", "parameters": {"type": "object", "properties": {"row": {"type": "integer", "description": "Row number (1-4)"}, "col": {"type": "integer", "description": "Column number (1-4)"}, "number": {"type": "integer", "description": "Digit to place (1-4)"}}, "required": ["row", "col", "number"], "additionalProperties": false}, "strict": true, "type": "function", "description": "Place a digit in the Sudoku grid"}]}, "response": {"id": "resp_68b21eef40a08190a48138297e47c50b0612f223b6f30a9b", "created_at": 1756503791.0, "error": null, "incomplete_details": null, "instructions": null, "metadata": {}, "model": "gpt-4.1-2025-04-14", "object": "response", "output": [{"call_id": "get_initial_board", "output": "{\"instructions\": \"You are playing a simple version of Sudoku.\\nEach row is numbered from 1 to 4, and each column is also numbered from 1 to 4.\\nEmpty cells are represented by '.', and pre-filled cells contain digits from 1 to 4.\\n\\nYour objective is to fill the empty cells in the 4x4 grid with digits from 1 to 4 such that:\\n1. Each row contains all digits from 1 to 4 without repetition.\\n2. Each column contains all digits from 1 to 4 without repetition.\\n3. Each 2x2 subgrid contains all digits from 1 to 4 without repetition.\\n\\nRules and Instructions:\\n1. **Do not overwrite** the initial numbers provided in the grid.\\n2. **Only fill** empty cells represented by '.'.\\n3. You must respond with the format '\\\\boxed{row column number}', e.g. \\\\boxed{1 1 5}.\\n4. **Ensure** that your move does not violate Sudoku rules. Invalid moves will result in penalties.\\nUse the make_move function to submit your moves. Good luck!\\n\\n\", \"board_text\": \"   C1 C2   C3 C4  \\nR1  .  . |  1  .\\nR2  .  3 |  4  2\\n   - - - - - - \\nR3  3  . |  2  .\\nR4  2  . |  3  .\", \"game_state\": {\"current_board\": [[0, 0, 1, 0], [0, 3, 4, 2], [3, 0, 2, 0], [2, 0, 3, 0]], \"solution\": [[4, 2, 1, 3], [1, 3, 4, 2], [3, 4, 2, 1], [2, 1, 3, 4]], \"scale\": 4, \"initial_empty_count\": 8, \"moves_made\": 0, \"correct_moves\": 0}}", "type": "function_call_output", "id": null, "status": null}, {"arguments": "{\"row\":1,\"col\":2,\"number\":4}", "call_id": "call_XT2dLwPEkitrUwC80TDVhJKS", "name": "make_move", "type": "function_call", "id": "fc_68b21ee1e1c48195998bf9f2c7e311260633a7ad28943cf0", "status": "completed"}, {"arguments": "{\"row\":1,\"col\":4,\"number\":3}", "call_id": "call_unYTQXgoK1VU0WKkLFVY7Hc3", "name": "make_move", "type": "function_call", "id": "fc_68b21ee213908195972a2f3769263bcb0633a7ad28943cf0", "status": "completed"}, {"call_id": "call_unYTQXgoK1VU0WKkLFVY7Hc3", "output": "{\"success\": true, \"message\": \"Correct move! R1 C4 = 3\", \"game_state\": {\"current_board\": [[0, 0, 1, 3], [0, 3, 4, 2], [3, 0, 2, 0], [2, 0, 3, 0]], \"solution\": [[4, 2, 1, 3], [1, 3, 4, 2], [3, 4, 2, 1], [2, 1, 3, 4]], \"scale\": 4, \"initial_empty_count\": 8, \"moves_made\": 1, \"correct_moves\": 1}, \"board_text\": \"   C1 C2   C3 C4  \\nR1  .  . |  1  3\\nR2  .  3 |  4  2\\n   - - - - - - \\nR3  3  . |  2  .\\nR4  2  . |  3  .\", \"is_complete\": false, \"move_reward\": 0.0}", "type": "function_call_output", "id": null, "status": null}, {"arguments": "{\"row\":1,\"col\":2,\"number\":4}", "call_id": "call_hR0GRpWuI6sH5mr1gkZZYBUj", "name": "make_move", "type": "function_call", "id": "fc_68b21ee32c008195ad9ff2c6c4a091ec0bb19a5c418f656d", "status": "completed"}, {"call_id": "call_hR0GRpWuI6sH5mr1gkZZYBUj", "output": "{\"success\": false, \"message\": \"Incorrect move: R1 C2 = 4 violates Sudoku rules\", \"game_state\": {\"current_board\": [[0, 0, 1, 3], [0, 3, 4, 2], [3, 0, 2, 0], [2, 0, 3, 0]], \"solution\": [[4, 2, 1, 3], [1, 3, 4, 2], [3, 4, 2, 1], [2, 1, 3, 4]], \"scale\": 4, \"initial_empty_count\": 8, \"moves_made\": 2, \"correct_moves\": 1}, \"board_text\": \"   C1 C2   C3 C4  \\nR1  .  . |  1  3\\nR2  .  3 |  4  2\\n   - - - - - - \\nR3  3  . |  2  .\\nR4  2  . |  3  .\", \"is_complete\": false, \"move_reward\": 0.0}", "type": "function_call_output", "id": null, "status": null}, {"arguments": "{\"row\":1,\"col\":2,\"number\":2}", "call_id": "call_uihE74RRv6wDijyBLpyiSxT4", "name": "make_move", "type": "function_call", "id": "fc_68b21ee4ca708190a5b4ea5125b76a090be606fee30f1d49", "status": "completed"}, {"call_id": "call_uihE74RRv6wDijyBLpyiSxT4", "output": "{\"success\": true, \"message\": \"Correct move! R1 C2 = 2\", \"game_state\": {\"current_board\": [[0, 2, 1, 3], [0, 3, 4, 2], [3, 0, 2, 0], [2, 0, 3, 0]], \"solution\": [[4, 2, 1, 3], [1, 3, 4, 2], [3, 4, 2, 1], [2, 1, 3, 4]], \"scale\": 4, \"initial_empty_count\": 8, \"moves_made\": 3, \"correct_moves\": 2}, \"board_text\": \"   C1 C2   C3 C4  \\nR1  .  2 |  1  3\\nR2  .  3 |  4  2\\n   - - - - - - \\nR3  3  . |  2  .\\nR4  2  . |  3  .\", \"is_complete\": false, \"move_reward\": 0.0}", "type": "function_call_output", "id": null, "status": null}, {"arguments": "{\"row\":1,\"col\":1,\"number\":4}", "call_id": "call_K8bl75AOTP4XDz6aIYkLACTe", "name": "make_move", "type": "function_call", "id": "fc_68b21ee61e9c8196adeb3f9d17fa33840f99a78f49bafd34", "status": "completed"}, {"call_id": "call_K8bl75AOTP4XDz6aIYkLACTe", "output": "{\"success\": true, \"message\": \"Correct move! R1 C1 = 4\", \"game_state\": {\"current_board\": [[4, 2, 1, 3], [0, 3, 4, 2], [3, 0, 2, 0], [2, 0, 3, 0]], \"solution\": [[4, 2, 1, 3], [1, 3, 4, 2], [3, 4, 2, 1], [2, 1, 3, 4]], \"scale\": 4, \"initial_empty_count\": 8, \"moves_made\": 4, \"correct_moves\": 3}, \"board_text\": \"   C1 C2   C3 C4  \\nR1  4  2 |  1  3\\nR2  .  3 |  4  2\\n   - - - - - - \\nR3  3  . |  2  .\\nR4  2  . |  3  .\", \"is_complete\": false, \"move_reward\": 0.0}", "type": "function_call_output", "id": null, "status": null}, {"arguments": "{\"row\":2,\"col\":1,\"number\":1}", "call_id": "call_qvnc7Eh87HxVcfzm6cwUjsPR", "name": "make_move", "type": "function_call", "id": "fc_68b21ee74a088194a6eee383c5401df30502bc1cac038d0e", "status": "completed"}, {"arguments": "{\"row\":3,\"col\":2,\"number\":4}", "call_id": "call_bFaRL9zcUq9Zzca5CpZCgYVP", "name": "make_move", "type": "function_call", "id": "fc_68b21ee76f288194b775e24570dd5cec0502bc1cac038d0e", "status": "completed"}, {"arguments": "{\"row\":3,\"col\":4,\"number\":1}", "call_id": "call_ZhvealpaR0hfKefhAsKX52kI", "name": "make_move", "type": "function_call", "id": "fc_68b21ee795b081949e4854df221214ec0502bc1cac038d0e", "status": "completed"}, {"arguments": "{\"row\":4,\"col\":2,\"number\":1}", "call_id": "call_jJAeWGI6Pa4toLgAnSzOsktZ", "name": "make_move", "type": "function_call", "id": "fc_68b21ee7c5048194a1fa288303c0cd0e0502bc1cac038d0e", "status": "completed"}, {"arguments": "{\"row\":4,\"col\":4,\"number\":4}", "call_id": "call_N0k1eWxQUh3mfTPRaw9y8BRI", "name": "make_move", "type": "function_call", "id": "fc_68b21ee801c48194946a2fb8292467540502bc1cac038d0e", "status": "completed"}, {"call_id": "call_N0k1eWxQUh3mfTPRaw9y8BRI", "output": "{\"success\": true, \"message\": \"Correct move! R4 C4 = 4\", \"game_state\": {\"current_board\": [[4, 2, 1, 3], [0, 3, 4, 2], [3, 0, 2, 0], [2, 0, 3, 4]], \"solution\": [[4, 2, 1, 3], [1, 3, 4, 2], [3, 4, 2, 1], [2, 1, 3, 4]], \"scale\": 4, \"initial_empty_count\": 8, \"moves_made\": 5, \"correct_moves\": 4}, \"board_text\": \"   C1 C2   C3 C4  \\nR1  4  2 |  1  3\\nR2  .  3 |  4  2\\n   - - - - - - \\nR3  3  . |  2  .\\nR4  2  . |  3  4\", \"is_complete\": false, \"move_reward\": 0.0}", "type": "function_call_output", "id": null, "status": null}, {"arguments": "{\"row\":2,\"col\":1,\"number\":1}", "call_id": "call_SI9q6qXekMEAvaxRNAuRfGUG", "name": "make_move", "type": "function_call", "id": "fc_68b21eea7f0c81978961139780e082280a667ea951e78915", "status": "completed"}, {"arguments": "{\"row\":3,\"col\":4,\"number\":1}", "call_id": "call_N6ajjKqAHv5tYMpSPyWrwS3c", "name": "make_move", "type": "function_call", "id": "fc_68b21eeac0688197aa09bb31275c92680a667ea951e78915", "status": "completed"}, {"arguments": "{\"row\":3,\"col\":2,\"number\":4}", "call_id": "call_KRMi2uSxFyd8M0e0y8cXPPLU", "name": "make_move", "type": "function_call", "id": "fc_68b21eeb03d48197b9b7831b899cf0b20a667ea951e78915", "status": "completed"}, {"arguments": "{\"row\":4,\"col\":2,\"number\":1}", "call_id": "call_QI8VQ8VAxK4Y7MIuwjMTEMWE", "name": "make_move", "type": "function_call", "id": "fc_68b21eeb2e588197b911fd9e3c6566630a667ea951e78915", "status": "completed"}, {"call_id": "call_QI8VQ8VAxK4Y7MIuwjMTEMWE", "output": "{\"success\": true, \"message\": \"Correct move! R4 C2 = 1\", \"game_state\": {\"current_board\": [[4, 2, 1, 3], [0, 3, 4, 2], [3, 0, 2, 0], [2, 1, 3, 4]], \"solution\": [[4, 2, 1, 3], [1, 3, 4, 2], [3, 4, 2, 1], [2, 1, 3, 4]], \"scale\": 4, \"initial_empty_count\": 8, \"moves_made\": 6, \"correct_moves\": 5}, \"board_text\": \"   C1 C2   C3 C4  \\nR1  4  2 |  1  3\\nR2  .  3 |  4  2\\n   - - - - - - \\nR3  3  . |  2  .\\nR4  2  1 |  3  4\", \"is_complete\": false, \"move_reward\": 0.0}", "type": "function_call_output", "id": null, "status": null}, {"arguments": "{\"row\":2,\"col\":1,\"number\":1}", "call_id": "call_euuJOpWokxfwQJXAIPBly7ac", "name": "make_move", "type": "function_call", "id": "fc_68b21eecc93081939a5259acb97974f305d14fcb03bf0e2f", "status": "completed"}, {"arguments": "{\"row\":3,\"col\":2,\"number\":4}", "call_id": "call_5GbNKL0QdxwqO2abLpTzV73j", "name": "make_move", "type": "function_call", "id": "fc_68b21eecf6cc8193b6526e33dd565efd05d14fcb03bf0e2f", "status": "completed"}, {"call_id": "call_5GbNKL0QdxwqO2abLpTzV73j", "output": "{\"success\": true, \"message\": \"Correct move! R3 C2 = 4\", \"game_state\": {\"current_board\": [[4, 2, 1, 3], [0, 3, 4, 2], [3, 4, 2, 0], [2, 1, 3, 4]], \"solution\": [[4, 2, 1, 3], [1, 3, 4, 2], [3, 4, 2, 1], [2, 1, 3, 4]], \"scale\": 4, \"initial_empty_count\": 8, \"moves_made\": 7, \"correct_moves\": 6}, \"board_text\": \"   C1 C2   C3 C4  \\nR1  4  2 |  1  3\\nR2  .  3 |  4  2\\n   - - - - - - \\nR3  3  4 |  2  .\\nR4  2  1 |  3  4\", \"is_complete\": false, \"move_reward\": 0.0}", "type": "function_call_output", "id": null, "status": null}, {"arguments": "{\"row\":2,\"col\":1,\"number\":1}", "call_id": "call_EoXnbDI17hixzAy7ZK3U6xFx", "name": "make_move", "type": "function_call", "id": "fc_68b21eee47ac8194a75ef79ef452acbf02924a853df5bdde", "status": "completed"}, {"arguments": "{\"row\":3,\"col\":4,\"number\":1}", "call_id": "call_TJgjvnCcqpMlgxoVwtcCnM5K", "name": "make_move", "type": "function_call", "id": "fc_68b21eee8c64819484ca1b4cf7391fca02924a853df5bdde", "status": "completed"}, {"call_id": "call_TJgjvnCcqpMlgxoVwtcCnM5K", "output": "{\"success\": true, \"message\": \"Correct move! R3 C4 = 1\", \"game_state\": {\"current_board\": [[4, 2, 1, 3], [0, 3, 4, 2], [3, 4, 2, 1], [2, 1, 3, 4]], \"solution\": [[4, 2, 1, 3], [1, 3, 4, 2], [3, 4, 2, 1], [2, 1, 3, 4]], \"scale\": 4, \"initial_empty_count\": 8, \"moves_made\": 8, \"correct_moves\": 7}, \"board_text\": \"   C1 C2   C3 C4  \\nR1  4  2 |  1  3\\nR2  .  3 |  4  2\\n   - - - - - - \\nR3  3  4 |  2  1\\nR4  2  1 |  3  4\", \"is_complete\": false, \"move_reward\": 0.0}", "type": "function_call_output", "id": null, "status": null}, {"arguments": "{\"row\":2,\"col\":1,\"number\":1}", "call_id": "call_nXq2go1TSh16BRNAMc65TKvX", "name": "make_move", "type": "function_call", "id": "fc_68b21eefd2f48190a91cdbffa7a9ec470612f223b6f30a9b", "status": "completed"}, {"call_id": "call_nXq2go1TSh16BRNAMc65TKvX", "output": "{\"success\": true, \"message\": \"Correct move! R2 C1 = 1. Congratulations! Puzzle completed!\", \"game_state\": {\"current_board\": [[4, 2, 1, 3], [1, 3, 4, 2], [3, 4, 2, 1], [2, 1, 3, 4]], \"solution\": [[4, 2, 1, 3], [1, 3, 4, 2], [3, 4, 2, 1], [2, 1, 3, 4]], \"scale\": 4, \"initial_empty_count\": 8, \"moves_made\": 9, \"correct_moves\": 8}, \"board_text\": \"   C1 C2   C3 C4  \\nR1  4  2 |  1  3\\nR2  1  3 |  4  2\\n   - - - - - - \\nR3  3  4 |  2  1\\nR4  2  1 |  3  4\", \"is_complete\": true, \"move_reward\": 1.0}", "type": "function_call_output", "id": null, "status": null}], "parallel_tool_calls": true, "temperature": 1.0, "tool_choice": "auto", "tools": [{"name": "make_move", "parameters": {"type": "object", "properties": {"row": {"type": "integer", "description": "Row number (1-4)"}, "col": {"type": "integer", "description": "Column number (1-4)"}, "number": {"type": "integer", "description": "Digit to place (1-4)"}}, "required": ["row", "col", "number"], "additionalProperties": false}, "strict": true, "type": "function", "description": "Place a digit in the Sudoku grid"}], "top_p": 1.0, "background": false, "max_output_tokens": null, "max_tool_calls": null, "previous_response_id": null, "prompt": null, "reasoning": {"effort": null, "generate_summary": null, "summary": null}, "service_tier": "default", "status": "completed", "text": {"format": {"type": "text"}, "verbosity": "medium"}, "top_logprobs": 0, "truncation": "disabled", "usage": {"input_tokens": 1102, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 23, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1125}, "user": null, "prompt_cache_key": null, "safety_identifier": null, "store": true}, "reward": 1.0, "total_moves": 9, "is_complete": true}
```

---